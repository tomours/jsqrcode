!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).zqrcode=t()}(this,(function(){"use strict";var e=3,t=57,n=8,i=2;function r(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",(function(){return this.estimatedModuleSize})),this.__defineGetter__("Count",(function(){return this.count})),this.__defineGetter__("X",(function(){return this.x})),this.__defineGetter__("Y",(function(){return this.y})),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var i=Math.abs(e-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1}}function o(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],this.__defineGetter__("BottomLeft",(function(){return this.bottomLeft})),this.__defineGetter__("TopLeft",(function(){return this.topLeft})),this.__defineGetter__("TopRight",(function(){return this.topRight}))}function s(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",(function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount})),this.foundPatternCross=function(e){for(var t=0,i=0;i<5;i++){var r=e[i];if(0==r)return!1;t+=r}if(t<7)return!1;var o=Math.floor((t<<n)/7),s=Math.floor(o/2);return Math.abs(o-(e[0]<<n))<s&&Math.abs(o-(e[1]<<n))<s&&Math.abs(3*o-(e[2]<<n))<3*s&&Math.abs(o-(e[3]<<n))<s&&Math.abs(o-(e[4]<<n))<s},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,n,i){for(var r=this.image,o=F.height,s=this.CrossCheckStateCount,a=e;a>=0&&r[t+a*F.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!r[t+a*F.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&r[t+a*F.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&r[t+a*F.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!r[t+a*F.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&r[t+a*F.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var h=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN},this.crossCheckHorizontal=function(e,t,n,i){for(var r=this.image,o=F.width,s=this.CrossCheckStateCount,a=e;a>=0&&r[a+t*F.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!r[a+t*F.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&r[a+t*F.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&r[a+t*F.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!r[a+t*F.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&r[a+t*F.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var h=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(h-i)>=i?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN},this.handlePossibleCenter=function(e,t,n){var i=e[0]+e[1]+e[2]+e[3]+e[4],o=this.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(o),e[2],i);if(!isNaN(s)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(s),e[2],i),!isNaN(o))){for(var a=i/7,h=!1,w=this.possibleCenters.length,f=0;f<w;f++){var u=this.possibleCenters[f];if(u.aboutEquals(a,s,o)){u.incrementCount(),h=!0;break}}if(!h){var d=new r(o,s,a);this.possibleCenters.push(d),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(d)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(e<3)throw"Couldn't find enough finder patterns (found "+e+")";if(e>3){for(var t=0,n=0,i=0;i<e;i++){var r=this.possibleCenters[i].EstimatedModuleSize;t+=r,n+=r*r}var o=t/e;this.possibleCenters.sort((function(e,t){var n=Math.abs(t.EstimatedModuleSize-o),i=Math.abs(e.EstimatedModuleSize-o);return n<i?-1:n==i?0:1}));var s=Math.sqrt(n/e-o*o),a=Math.max(.2*o,s);for(i=this.possibleCenters.length-1;i>=0;i--){var h=this.possibleCenters[i];Math.abs(h.EstimatedModuleSize-o)>a&&this.possibleCenters.splice(i,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort((function(e,t){return e.count>t.count?-1:e.count<t.count?1:0})),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(e<=1)return 0;for(var t=null,n=0;n<e;n++){var r=this.possibleCenters[n];if(r.Count>=i){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2);t=r}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;r<n;r++){var o=this.possibleCenters[r];o.Count>=i&&(e++,t+=o.EstimatedModuleSize)}if(e<3)return!1;var s=t/n,a=0;for(r=0;r<n;r++)o=this.possibleCenters[r],a+=Math.abs(o.EstimatedModuleSize-s);return a<=.05*t},this.findFinderPattern=function(n){this.image=n;var i=F.height,r=F.width,s=Math.floor(3*i/(4*t));s<e&&(s=e);for(var a=!1,h=new Array(5),w=s-1;w<i&&!a;w+=s){h[0]=0,h[1]=0,h[2]=0,h[3]=0,h[4]=0;for(var f=0,u=0;u<r;u++)if(n[u+w*F.width])1==(1&f)&&f++,h[f]++;else if(0==(1&f))if(4==f)if(this.foundPatternCross(h)){if(this.handlePossibleCenter(h,w,u))if(s=2,this.hasSkipped)a=this.haveMultiplyConfirmedCenters();else{var d=this.findRowSkip();d>h[2]&&(w+=d-h[2]-s,u=r-1)}else{do{u++}while(u<r&&!n[u+w*F.width]);u--}f=0,h[0]=0,h[1]=0,h[2]=0,h[3]=0,h[4]=0}else h[0]=h[2],h[1]=h[3],h[2]=h[4],h[3]=1,h[4]=0,f=3;else h[++f]++;else h[f]++;if(this.foundPatternCross(h))this.handlePossibleCenter(h,w,r)&&(s=h[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}var l=this.selectBestPatterns();return function(e){function t(e,t){var n=e.X-t.X,i=e.Y-t.Y;return Math.sqrt(n*n+i*i)}var n,i,r,o=t(e[0],e[1]),s=t(e[1],e[2]),a=t(e[0],e[2]);if(s>=o&&s>=a?(i=e[0],n=e[1],r=e[2]):a>=s&&a>=o?(i=e[1],n=e[0],r=e[2]):(i=e[2],n=e[0],r=e[1]),function(e,t,n){var i=t.x,r=t.y;return(n.x-i)*(e.y-r)-(n.y-r)*(e.x-i)}(n,i,r)<0){var h=n;n=r,r=h}e[0]=n,e[1]=i,e[2]=r}(l),new o(l)}}function a(e,t){if(t||(t=e),e<1||t<1)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;0!=(31&e)&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var i=0;i<this.bits.length;i++)this.bits[i]=0;this.__defineGetter__("Width",(function(){return this.width})),this.__defineGetter__("Height",(function(){return this.height})),this.__defineGetter__("Dimension",(function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width})),this.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&I(this.bits[n],31&e))},this.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},this.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0},this.setRegion=function(e,t,n,i){if(t<0||e<0)throw"Left and top must be nonnegative";if(i<1||n<1)throw"Height and width must be at least 1";var r=e+n,o=t+i;if(o>this.height||r>this.width)throw"The region must fit inside the matrix";for(var s=t;s<o;s++)for(var a=s*this.rowSize,h=e;h<r;h++)this.bits[a+(h>>5)]|=1<<(31&h)}}function h(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n,this.__defineGetter__("Bits",(function(){return this.bits})),this.__defineGetter__("Name",(function(){return this.name})),this.ordinal=function(){return this.ordinal_Renamed_Field}}h.forBits=function(e){if(e<0||e>=l.length)throw"ArgumentException";return l[e]};var w=new h(0,1,"L"),f=new h(1,0,"M"),u=new h(2,3,"Q"),d=new h(3,2,"H"),l=new Array(f,w,d,u),c=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),g=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);function v(e){this.errorCorrectionLevel=h.forBits(e>>3&3),this.dataMask=7&e,this.__defineGetter__("ErrorCorrectionLevel",(function(){return this.errorCorrectionLevel})),this.__defineGetter__("DataMask",(function(){return this.dataMask})),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}function m(e,t){this.count=e,this.dataCodewords=t,this.__defineGetter__("Count",(function(){return this.count})),this.__defineGetter__("DataCodewords",(function(){return this.dataCodewords}))}function b(e,t,n){this.ecCodewordsPerBlock=e,this.ecBlocks=n?new Array(t,n):new Array(t),this.__defineGetter__("ECCodewordsPerBlock",(function(){return this.ecCodewordsPerBlock})),this.__defineGetter__("TotalECCodewords",(function(){return this.ecCodewordsPerBlock*this.NumBlocks})),this.__defineGetter__("NumBlocks",(function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e})),this.getECBlocks=function(){return this.ecBlocks}}function y(e,t,n,i,r,o){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(n,i,r,o);for(var s=0,h=n.ECCodewordsPerBlock,w=n.getECBlocks(),f=0;f<w.length;f++){var u=w[f];s+=u.Count*(u.DataCodewords+h)}this.totalCodewords=s,this.__defineGetter__("VersionNumber",(function(){return this.versionNumber})),this.__defineGetter__("AlignmentPatternCenters",(function(){return this.alignmentPatternCenters})),this.__defineGetter__("TotalCodewords",(function(){return this.totalCodewords})),this.__defineGetter__("DimensionForVersion",(function(){return 17+4*this.versionNumber})),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new a(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,i=0;i<n;i++)for(var r=this.alignmentPatternCenters[i]-2,o=0;o<n;o++)0==i&&(0==o||o==n-1)||i==n-1&&0==o||t.setRegion(this.alignmentPatternCenters[o]-2,r,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}function C(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",(function(){return this.estimatedModuleSize})),this.__defineGetter__("Count",(function(){return this.count})),this.__defineGetter__("X",(function(){return Math.floor(this.x)})),this.__defineGetter__("Y",(function(){return Math.floor(this.y)})),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var i=Math.abs(e-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1}}function _(e,t,n,i,r,o,s){this.image=e,this.possibleCenters=new Array,this.startX=t,this.startY=n,this.width=i,this.height=r,this.moduleSize=o,this.crossCheckStateCount=new Array(0,0,0),this.resultPointCallback=s,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,i=0;i<3;i++)if(Math.abs(t-e[i])>=n)return!1;return!0},this.crossCheckVertical=function(e,t,n,i){var r=this.image,o=F.height,s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var a=e;a>=0&&r[t+a*F.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&!r[t+a*F.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&r[t+a*F.width]&&s[1]<=n;)s[1]++,a++;if(a==o||s[1]>n)return NaN;for(;a<o&&!r[t+a*F.width]&&s[2]<=n;)s[2]++,a++;if(s[2]>n)return NaN;var h=s[0]+s[1]+s[2];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN},this.handlePossibleCenter=function(e,t,n){var i=e[0]+e[1]+e[2],r=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(r),2*e[1],i);if(!isNaN(o)){for(var s=(e[0]+e[1]+e[2])/3,a=this.possibleCenters.length,h=0;h<a;h++){if(this.possibleCenters[h].aboutEquals(s,o,r))return new C(r,o,s)}var w=new C(r,o,s);this.possibleCenters.push(w),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(w)}return null},this.find=function(){for(var t=this.startX,r=this.height,o=t+i,s=n+(r>>1),a=new Array(0,0,0),h=0;h<r;h++){var w=s+(0==(1&h)?h+1>>1:-(h+1>>1));a[0]=0,a[1]=0,a[2]=0;for(var f=t;f<o&&!e[f+F.width*w];)f++;for(var u=0;f<o;){if(e[f+w*F.width])if(1==u)a[u]++;else if(2==u){var d;if(this.foundPatternCross(a))if(null!=(d=this.handlePossibleCenter(a,w,f)))return d;a[0]=a[2],a[1]=1,a[2]=0,u=1}else a[++u]++;else 1==u&&u++,a[u]++;f++}if(this.foundPatternCross(a))if(null!=(d=this.handlePossibleCenter(a,w,o)))return d}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}}v.numBitsDiffering=function(e,t){return g[15&(e^=t)]+g[15&I(e,4)]+g[15&I(e,8)]+g[15&I(e,12)]+g[15&I(e,16)]+g[15&I(e,20)]+g[15&I(e,24)]+g[15&I(e,28)]},v.decodeFormatInformation=function(e){var t=v.doDecodeFormatInformation(e);return null!=t?t:v.doDecodeFormatInformation(21522^e)},v.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,i=0;i<c.length;i++){var r=c[i],o=r[0];if(o==e)return new v(r[1]);var s=this.numBitsDiffering(e,o);s<t&&(n=r[1],t=s)}return t<=3?new v(n):null},y.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),y.VERSIONS=new Array(new y(1,new Array,new b(7,new m(1,19)),new b(10,new m(1,16)),new b(13,new m(1,13)),new b(17,new m(1,9))),new y(2,new Array(6,18),new b(10,new m(1,34)),new b(16,new m(1,28)),new b(22,new m(1,22)),new b(28,new m(1,16))),new y(3,new Array(6,22),new b(15,new m(1,55)),new b(26,new m(1,44)),new b(18,new m(2,17)),new b(22,new m(2,13))),new y(4,new Array(6,26),new b(20,new m(1,80)),new b(18,new m(2,32)),new b(26,new m(2,24)),new b(16,new m(4,9))),new y(5,new Array(6,30),new b(26,new m(1,108)),new b(24,new m(2,43)),new b(18,new m(2,15),new m(2,16)),new b(22,new m(2,11),new m(2,12))),new y(6,new Array(6,34),new b(18,new m(2,68)),new b(16,new m(4,27)),new b(24,new m(4,19)),new b(28,new m(4,15))),new y(7,new Array(6,22,38),new b(20,new m(2,78)),new b(18,new m(4,31)),new b(18,new m(2,14),new m(4,15)),new b(26,new m(4,13),new m(1,14))),new y(8,new Array(6,24,42),new b(24,new m(2,97)),new b(22,new m(2,38),new m(2,39)),new b(22,new m(4,18),new m(2,19)),new b(26,new m(4,14),new m(2,15))),new y(9,new Array(6,26,46),new b(30,new m(2,116)),new b(22,new m(3,36),new m(2,37)),new b(20,new m(4,16),new m(4,17)),new b(24,new m(4,12),new m(4,13))),new y(10,new Array(6,28,50),new b(18,new m(2,68),new m(2,69)),new b(26,new m(4,43),new m(1,44)),new b(24,new m(6,19),new m(2,20)),new b(28,new m(6,15),new m(2,16))),new y(11,new Array(6,30,54),new b(20,new m(4,81)),new b(30,new m(1,50),new m(4,51)),new b(28,new m(4,22),new m(4,23)),new b(24,new m(3,12),new m(8,13))),new y(12,new Array(6,32,58),new b(24,new m(2,92),new m(2,93)),new b(22,new m(6,36),new m(2,37)),new b(26,new m(4,20),new m(6,21)),new b(28,new m(7,14),new m(4,15))),new y(13,new Array(6,34,62),new b(26,new m(4,107)),new b(22,new m(8,37),new m(1,38)),new b(24,new m(8,20),new m(4,21)),new b(22,new m(12,11),new m(4,12))),new y(14,new Array(6,26,46,66),new b(30,new m(3,115),new m(1,116)),new b(24,new m(4,40),new m(5,41)),new b(20,new m(11,16),new m(5,17)),new b(24,new m(11,12),new m(5,13))),new y(15,new Array(6,26,48,70),new b(22,new m(5,87),new m(1,88)),new b(24,new m(5,41),new m(5,42)),new b(30,new m(5,24),new m(7,25)),new b(24,new m(11,12),new m(7,13))),new y(16,new Array(6,26,50,74),new b(24,new m(5,98),new m(1,99)),new b(28,new m(7,45),new m(3,46)),new b(24,new m(15,19),new m(2,20)),new b(30,new m(3,15),new m(13,16))),new y(17,new Array(6,30,54,78),new b(28,new m(1,107),new m(5,108)),new b(28,new m(10,46),new m(1,47)),new b(28,new m(1,22),new m(15,23)),new b(28,new m(2,14),new m(17,15))),new y(18,new Array(6,30,56,82),new b(30,new m(5,120),new m(1,121)),new b(26,new m(9,43),new m(4,44)),new b(28,new m(17,22),new m(1,23)),new b(28,new m(2,14),new m(19,15))),new y(19,new Array(6,30,58,86),new b(28,new m(3,113),new m(4,114)),new b(26,new m(3,44),new m(11,45)),new b(26,new m(17,21),new m(4,22)),new b(26,new m(9,13),new m(16,14))),new y(20,new Array(6,34,62,90),new b(28,new m(3,107),new m(5,108)),new b(26,new m(3,41),new m(13,42)),new b(30,new m(15,24),new m(5,25)),new b(28,new m(15,15),new m(10,16))),new y(21,new Array(6,28,50,72,94),new b(28,new m(4,116),new m(4,117)),new b(26,new m(17,42)),new b(28,new m(17,22),new m(6,23)),new b(30,new m(19,16),new m(6,17))),new y(22,new Array(6,26,50,74,98),new b(28,new m(2,111),new m(7,112)),new b(28,new m(17,46)),new b(30,new m(7,24),new m(16,25)),new b(24,new m(34,13))),new y(23,new Array(6,30,54,74,102),new b(30,new m(4,121),new m(5,122)),new b(28,new m(4,47),new m(14,48)),new b(30,new m(11,24),new m(14,25)),new b(30,new m(16,15),new m(14,16))),new y(24,new Array(6,28,54,80,106),new b(30,new m(6,117),new m(4,118)),new b(28,new m(6,45),new m(14,46)),new b(30,new m(11,24),new m(16,25)),new b(30,new m(30,16),new m(2,17))),new y(25,new Array(6,32,58,84,110),new b(26,new m(8,106),new m(4,107)),new b(28,new m(8,47),new m(13,48)),new b(30,new m(7,24),new m(22,25)),new b(30,new m(22,15),new m(13,16))),new y(26,new Array(6,30,58,86,114),new b(28,new m(10,114),new m(2,115)),new b(28,new m(19,46),new m(4,47)),new b(28,new m(28,22),new m(6,23)),new b(30,new m(33,16),new m(4,17))),new y(27,new Array(6,34,62,90,118),new b(30,new m(8,122),new m(4,123)),new b(28,new m(22,45),new m(3,46)),new b(30,new m(8,23),new m(26,24)),new b(30,new m(12,15),new m(28,16))),new y(28,new Array(6,26,50,74,98,122),new b(30,new m(3,117),new m(10,118)),new b(28,new m(3,45),new m(23,46)),new b(30,new m(4,24),new m(31,25)),new b(30,new m(11,15),new m(31,16))),new y(29,new Array(6,30,54,78,102,126),new b(30,new m(7,116),new m(7,117)),new b(28,new m(21,45),new m(7,46)),new b(30,new m(1,23),new m(37,24)),new b(30,new m(19,15),new m(26,16))),new y(30,new Array(6,26,52,78,104,130),new b(30,new m(5,115),new m(10,116)),new b(28,new m(19,47),new m(10,48)),new b(30,new m(15,24),new m(25,25)),new b(30,new m(23,15),new m(25,16))),new y(31,new Array(6,30,56,82,108,134),new b(30,new m(13,115),new m(3,116)),new b(28,new m(2,46),new m(29,47)),new b(30,new m(42,24),new m(1,25)),new b(30,new m(23,15),new m(28,16))),new y(32,new Array(6,34,60,86,112,138),new b(30,new m(17,115)),new b(28,new m(10,46),new m(23,47)),new b(30,new m(10,24),new m(35,25)),new b(30,new m(19,15),new m(35,16))),new y(33,new Array(6,30,58,86,114,142),new b(30,new m(17,115),new m(1,116)),new b(28,new m(14,46),new m(21,47)),new b(30,new m(29,24),new m(19,25)),new b(30,new m(11,15),new m(46,16))),new y(34,new Array(6,34,62,90,118,146),new b(30,new m(13,115),new m(6,116)),new b(28,new m(14,46),new m(23,47)),new b(30,new m(44,24),new m(7,25)),new b(30,new m(59,16),new m(1,17))),new y(35,new Array(6,30,54,78,102,126,150),new b(30,new m(12,121),new m(7,122)),new b(28,new m(12,47),new m(26,48)),new b(30,new m(39,24),new m(14,25)),new b(30,new m(22,15),new m(41,16))),new y(36,new Array(6,24,50,76,102,128,154),new b(30,new m(6,121),new m(14,122)),new b(28,new m(6,47),new m(34,48)),new b(30,new m(46,24),new m(10,25)),new b(30,new m(2,15),new m(64,16))),new y(37,new Array(6,28,54,80,106,132,158),new b(30,new m(17,122),new m(4,123)),new b(28,new m(29,46),new m(14,47)),new b(30,new m(49,24),new m(10,25)),new b(30,new m(24,15),new m(46,16))),new y(38,new Array(6,32,58,84,110,136,162),new b(30,new m(4,122),new m(18,123)),new b(28,new m(13,46),new m(32,47)),new b(30,new m(48,24),new m(14,25)),new b(30,new m(42,15),new m(32,16))),new y(39,new Array(6,26,54,82,110,138,166),new b(30,new m(20,117),new m(4,118)),new b(28,new m(40,47),new m(7,48)),new b(30,new m(43,24),new m(22,25)),new b(30,new m(10,15),new m(67,16))),new y(40,new Array(6,30,58,86,114,142,170),new b(30,new m(19,118),new m(6,119)),new b(28,new m(18,47),new m(31,48)),new b(30,new m(34,24),new m(34,25)),new b(30,new m(20,15),new m(61,16)))),y.getVersionForNumber=function(e){if(e<1||e>40)throw"ArgumentException";return y.VERSIONS[e-1]},y.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return y.getVersionForNumber(e-17>>2)}catch(e){throw"Error getVersionForNumber"}},y.decodeVersionInformation=function(e){for(var t=4294967295,n=0,i=0;i<y.VERSION_DECODE_INFO.length;i++){var r=y.VERSION_DECODE_INFO[i];if(r==e)return this.getVersionForNumber(i+7);var o=v.numBitsDiffering(e,r);o<t&&(n=i+7,t=o)}return t<=3?this.getVersionForNumber(n):null};var p={};function A(e,t,n,i,r,o,s,a,h){this.a11=e,this.a12=i,this.a13=s,this.a21=t,this.a22=r,this.a23=a,this.a31=n,this.a32=o,this.a33=h,this.transformPoints1=function(e){for(var t=e.length,n=this.a11,i=this.a12,r=this.a13,o=this.a21,s=this.a22,a=this.a23,h=this.a31,w=this.a32,f=this.a33,u=0;u<t;u+=2){var d=e[u],l=e[u+1],c=r*d+a*l+f;e[u]=(n*d+o*l+h)/c,e[u+1]=(i*d+s*l+w)/c}},this.transformPoints2=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i],o=t[i],s=this.a13*r+this.a23*o+this.a33;e[i]=(this.a11*r+this.a21*o+this.a31)/s,t[i]=(this.a12*r+this.a22*o+this.a32)/s}},this.buildAdjoint=function(){return new A(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new A(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function M(e,t){this.bits=e,this.points=t}function k(e){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(e,t,n,i){var r=Math.abs(i-t)>Math.abs(n-e);if(r){var o=e;e=t,t=o,o=n,n=i,i=o}for(var s=Math.abs(n-e),a=Math.abs(i-t),h=-s>>1,w=t<i?1:-1,f=e<n?1:-1,u=0,d=e,l=t;d!=n;d+=f){var c=r?l:d,g=r?d:l;if(1==u?this.image[c+g*F.width]&&u++:this.image[c+g*F.width]||u++,3==u){var v=d-e,m=l-t;return Math.sqrt(v*v+m*m)}if((h+=a)>0){if(l==i)break;l+=w,h-=s}}var b=n-e,y=i-t;return Math.sqrt(b*b+y*y)},this.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,i){var r=this.sizeOfBlackWhiteBlackRun(e,t,n,i),o=1,s=e-(n-e);s<0?(o=e/(e-s),s=0):s>=F.width&&(o=(F.width-1-e)/(s-e),s=F.width-1);var a=Math.floor(t-(i-t)*o);return o=1,a<0?(o=t/(t-a),a=0):a>=F.height&&(o=(F.height-1-t)/(a-t),a=F.height-1),s=Math.floor(e+(s-e)*o),(r+=this.sizeOfBlackWhiteBlackRun(e,t,s,a))-1},this.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?i/7:isNaN(i)?n/7:(n+i)/14},this.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},this.distance=function(e,t){var n=e.X-t.X,i=e.Y-t.Y;return Math.sqrt(n*n+i*i)},this.computeDimension=function(e,t,n,i){var r=7+(Math.round(this.distance(e,t)/i)+Math.round(this.distance(e,n)/i)>>1);switch(3&r){case 0:r++;break;case 2:r--;break;case 3:throw"Error"}return r},this.findAlignmentInRegion=function(e,t,n,i){var r=Math.floor(i*e),o=Math.max(0,t-r),s=Math.min(F.width-1,t+r);if(s-o<3*e)throw"Error";var a=Math.max(0,n-r),h=Math.min(F.height-1,n+r);return new _(this.image,o,a,s-o,h-a,e,this.resultPointCallback).find()},this.createTransform=function(e,t,n,i,r){var o,s,a,h,w=r-3.5;return null!=i?(o=i.X,s=i.Y,a=h=w-3):(o=t.X-e.X+n.X,s=t.Y-e.Y+n.Y,a=h=w),A.quadrilateralToQuadrilateral(3.5,3.5,w,3.5,a,h,3.5,w,e.X,e.Y,t.X,t.Y,o,s,n.X,n.Y)},this.sampleGrid=function(e,t,n){return p.sampleGrid3(e,n,t)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,i=e.BottomLeft,r=this.calculateModuleSize(t,n,i);if(r<1)throw"Error";var o=this.computeDimension(t,n,i,r),s=y.getProvisionalVersionForDimension(o),a=s.DimensionForVersion-7,h=null;if(s.AlignmentPatternCenters.length>0)for(var w=n.X-t.X+i.X,f=n.Y-t.Y+i.Y,u=1-3/a,d=Math.floor(t.X+u*(w-t.X)),l=Math.floor(t.Y+u*(f-t.Y)),c=4;c<=16;c<<=1){h=this.findAlignmentInRegion(r,d,l,c);break}var g=this.createTransform(t,n,i,h,o);return new M(this.sampleGrid(this.image,g,o),null==h?new Array(i,t,n):new Array(i,t,n,h))},this.detect=function(){var e=(new s).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}function P(e,t){if(null==t||0==t.length)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&0==t[0]){for(var i=1;i<n&&0==t[i];)i++;if(i==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-i);for(var r=0;r<this.coefficients.length;r++)this.coefficients[r]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=t[i+o]}}else this.coefficients=t;this.__defineGetter__("Zero",(function(){return 0==this.coefficients[0]})),this.__defineGetter__("Degree",(function(){return this.coefficients.length-1})),this.__defineGetter__("Coefficients",(function(){return this.coefficients})),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var n=0,i=0;i<t;i++)n=S.addOrSubtract(n,this.coefficients[i]);return n}var r=this.coefficients[0];for(i=1;i<t;i++)r=S.addOrSubtract(this.field.multiply(e,r),this.coefficients[i]);return r},this.addOrSubtract=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return t;if(t.Zero)return this;var n=this.coefficients,i=t.coefficients;if(n.length>i.length){var r=n;n=i,i=r}for(var o=new Array(i.length),s=i.length-n.length,a=0;a<s;a++)o[a]=i[a];for(var h=s;h<i.length;h++)o[h]=S.addOrSubtract(n[h-s],i[h]);return new P(e,o)},this.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,n=t.length,i=e.coefficients,r=i.length,o=new Array(n+r-1),s=0;s<n;s++)for(var a=t[s],h=0;h<r;h++)o[s+h]=S.addOrSubtract(o[s+h],this.field.multiply(a,i[h]));return new P(this.field,o)},this.multiply2=function(e){if(0==e)return this.field.Zero;if(1==e)return this;for(var t=this.coefficients.length,n=new Array(t),i=0;i<t;i++)n[i]=this.field.multiply(this.coefficients[i],e);return new P(this.field,n)},this.multiplyByMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(0==t)return this.field.Zero;for(var n=this.coefficients.length,i=new Array(n+e),r=0;r<i.length;r++)i[r]=0;for(r=0;r<n;r++)i[r]=this.field.multiply(this.coefficients[r],t);return new P(this.field,i)},this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,i=e.getCoefficient(e.Degree),r=this.field.inverse(i);n.Degree>=e.Degree&&!n.Zero;){var o=n.Degree-e.Degree,s=this.field.multiply(n.getCoefficient(n.Degree),r),a=e.multiplyByMonomial(o,s),h=this.field.buildMonomial(o,s);t=t.addOrSubtract(h),n=n.addOrSubtract(a)}return new Array(t,n)}}function S(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;n<256;n++)this.expTable[n]=t,(t<<=1)>=256&&(t^=e);for(n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var i=new Array(1);i[0]=0,this.zero=new P(this,new Array(i));var r=new Array(1);r[0]=1,this.one=new P(this,new Array(r)),this.__defineGetter__("Zero",(function(){return this.zero})),this.__defineGetter__("One",(function(){return this.one})),this.buildMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(0==t)return this.zero;for(var n=new Array(e+1),i=0;i<n.length;i++)n[i]=0;return n[0]=t,new P(this,n)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}p.checkAndNudgePoints=function(e,t){for(var n=F.width,i=F.height,r=!0,o=0;o<t.length&&r;o+=2){var s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>i)throw"Error.checkAndNudgePoints ";r=!1,-1==s?(t[o]=0,r=!0):s==n&&(t[o]=n-1,r=!0),-1==a?(t[o+1]=0,r=!0):a==i&&(t[o+1]=i-1,r=!0)}r=!0;for(o=t.length-2;o>=0&&r;o-=2){s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>i)throw"Error.checkAndNudgePoints ";r=!1,-1==s?(t[o]=0,r=!0):s==n&&(t[o]=n-1,r=!0),-1==a?(t[o+1]=0,r=!0):a==i&&(t[o+1]=i-1,r=!0)}},p.sampleGrid3=function(e,t,n){for(var i=new a(t),r=new Array(t<<1),o=0;o<t;o++){for(var s=r.length,h=o+.5,w=0;w<s;w+=2)r[w]=.5+(w>>1),r[w+1]=h;n.transformPoints1(r),p.checkAndNudgePoints(e,r);try{for(w=0;w<s;w+=2){e[Math.floor(r[w])+F.width*Math.floor(r[w+1])]&&i.set_Renamed(w>>1,o)}}catch(e){throw"Error.checkAndNudgePoints"}}return i},p.sampleGridx=function(e,t,n,i,r,o,s,a,h,w,f,u,d,l,c,g,v,m){var b=PerspectiveTransform.quadrilateralToQuadrilateral(n,i,r,o,s,a,h,w,f,u,d,l,c,g,v,m);return p.sampleGrid3(e,t,b)},A.quadrilateralToQuadrilateral=function(e,t,n,i,r,o,s,a,h,w,f,u,d,l,c,g){var v=this.quadrilateralToSquare(e,t,n,i,r,o,s,a);return this.squareToQuadrilateral(h,w,f,u,d,l,c,g).times(v)},A.squareToQuadrilateral=function(e,t,n,i,r,o,s,a){var h=a-o,w=t-i+o-a;if(0==h&&0==w)return new A(n-e,r-n,e,i-t,o-i,t,0,0,1);var f=n-r,u=s-r,d=e-n+r-s,l=i-o,c=f*h-u*l,g=(d*h-u*w)/c,v=(f*w-d*l)/c;return new A(n-e+g*n,s-e+v*s,e,i-t+g*i,a-t+v*a,t,g,v,1)},A.quadrilateralToSquare=function(e,t,n,i,r,o,s,a){return this.squareToQuadrilateral(e,t,n,i,r,o,s,a).buildAdjoint()},S.QR_CODE_FIELD=new S(285),S.DATA_MATRIX_FIELD=new S(301),S.addOrSubtract=function(e,t){return e^t};var N={};function B(e){var t=e.Dimension;if(t<21||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=v.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var i=this.bitMatrix.Dimension;e=0;var r=i-8;for(t=i-1;t>=r;t--)e=this.copyBit(t,8,e);for(n=i-7;n<i;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=v.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(t<=6)return y.getVersionForNumber(t);for(var n=0,i=e-11,r=5;r>=0;r--)for(var o=e-9;o>=i;o--)n=this.copyBit(o,r,n);if(this.parsedVersion=y.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(o=5;o>=0;o--)for(r=e-9;r>=i;r--)n=this.copyBit(o,r,n);if(this.parsedVersion=y.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=N.forReference(e.DataMask),i=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,i);for(var r=t.buildFunctionPattern(),o=!0,s=new Array(t.TotalCodewords),a=0,h=0,w=0,f=i-1;f>0;f-=2){6==f&&f--;for(var u=0;u<i;u++)for(var d=o?i-1-u:u,l=0;l<2;l++)r.get_Renamed(f-l,d)||(w++,h<<=1,this.bitMatrix.get_Renamed(f-l,d)&&(h|=1),8==w&&(s[a++]=h,w=0,h=0));o^=!0}if(a!=t.TotalCodewords)throw"Error readCodewords";return s}}function E(e,t){this.numDataCodewords=e,this.codewords=t,this.__defineGetter__("NumDataCodewords",(function(){return this.numDataCodewords})),this.__defineGetter__("Codewords",(function(){return this.codewords}))}function D(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2),this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,i=0;i<e;i++)n+=1<<i;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){var r=0;for(i=0;i<this.bitPointer+1;i++)r+=1<<i;return t=(this.blocks[this.blockPointer]&r)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){r=0;var o=0;for(i=0;i<this.bitPointer+1;i++)r+=1<<i;var s=(this.blocks[this.blockPointer]&r)<<e-(this.bitPointer+1);this.blockPointer++;var a=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(i=0;i<e-(this.bitPointer+1+8);i++)o+=1<<i;return o<<=8-(e-(this.bitPointer+1+8)),t=s+a+((this.blocks[this.blockPointer]&o)>>8-(e-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(F.sizeOfDataLengthInfo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,n=0,i="",r=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){var o=(n=this.getNextBits(11))%45;i+=r[Math.floor(n/45)],i+=r[o],t-=2}else 1==t&&(i+=r[n=this.getNextBits(6)],t-=1)}while(t>0);return i},this.getFigureString=function(e){var t=e,n=0,i="";do{t>=3?((n=this.getNextBits(10))<100&&(i+="0"),n<10&&(i+="0"),t-=3):2==t?((n=this.getNextBits(7))<10&&(i+="0"),t-=2):1==t&&(n=this.getNextBits(4),t-=1),i+=n}while(t>0);return i},this.get8bitByteArray=function(e){var t=e,n=0,i=new Array;do{n=this.getNextBits(8),i.push(n),t--}while(t>0);return i},this.getKanjiString=function(e){var t=e,n=0,i="";do{var r=((n=this.getNextBits(13))/192<<8)+n%192,o=0;o=r+33088<=40956?r+33088:r+49472,i+=String.fromCharCode(o),t--}while(t>0);return i},this.parseECIValue=function(){var e=0,t=this.getNextBits(8);(0==(128&t)&&(e=127&t),128==(192&t))&&(e=(63&t)<<8|this.getNextBits(8));192==(224&t)&&(e=(31&t)<<16|this.getNextBits(8));return e},this.__defineGetter__("DataByte",(function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t&&7!=t)throw"Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";if(7==t)var n=this.parseECIValue();else{var i=this.getDataLength(t);if(i<1)throw"Invalid data length: "+i;switch(t){case 1:for(var r=this.getFigureString(i),o=new Array(r.length),s=0;s<r.length;s++)o[s]=r.charCodeAt(s);e.push(o);break;case 2:for(r=this.getRomanAndFigureString(i),o=new Array(r.length),s=0;s<r.length;s++)o[s]=r.charCodeAt(s);e.push(o);break;case 4:n=this.get8bitByteArray(i);e.push(n);break;case 8:r=this.getKanjiString(i);e.push(r)}}}return e}))}N.forReference=function(e){if(e<0||e>7)throw"System.ArgumentException";return N.DATA_MASKS[e]},N.DATA_MASKS=new Array(new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==(e+t&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==(1&e)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return t%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return(e+t)%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==(I(e,1)+t/3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){var n=e*t;return(1&n)+n%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}),E.getDataBlocks=function(e,t,n){if(e.length!=t.TotalCodewords)throw"ArgumentException";for(var i=t.getECBlocksForLevel(n),r=0,o=i.getECBlocks(),s=0;s<o.length;s++)r+=o[s].Count;for(var a=new Array(r),h=0,w=0;w<o.length;w++){var f=o[w];for(s=0;s<f.Count;s++){var u=f.DataCodewords,d=i.ECCodewordsPerBlock+u;a[h++]=new E(u,new Array(d))}}for(var l=a[0].codewords.length,c=a.length-1;c>=0;){if(a[c].codewords.length==l)break;c--}c++;var g=l-i.ECCodewordsPerBlock,v=0;for(s=0;s<g;s++)for(w=0;w<h;w++)a[w].codewords[s]=e[v++];for(w=c;w<h;w++)a[w].codewords[g]=e[v++];var m=a[0].codewords.length;for(s=g;s<m;s++)for(w=0;w<h;w++){var b=w<c?s:s+1;a[w].codewords[b]=e[v++]}return a};var x={};x.rsDecoder=new function(e){this.field=e,this.decode=function(e,t){for(var n=new P(this.field,e),i=new Array(t),r=0;r<i.length;r++)i[r]=0;var o=!0;for(r=0;r<t;r++){var s=n.evaluateAt(this.field.exp(r));i[i.length-1-r]=s,0!=s&&(o=!1)}if(!o){var a=new P(this.field,i),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),a,t),w=h[0],f=h[1],u=this.findErrorLocations(w),d=this.findErrorMagnitudes(f,u,!1);for(r=0;r<u.length;r++){var l=e.length-1-this.field.log(u[r]);if(l<0)throw"ReedSolomonException Bad error location";e[l]=S.addOrSubtract(e[l],d[r])}}},this.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var i=e;e=t,t=i}for(var r=e,o=t,s=this.field.One,a=this.field.Zero,h=this.field.Zero,w=this.field.One;o.Degree>=Math.floor(n/2);){var f=r,u=s,d=h;if(s=a,h=w,(r=o).Zero)throw"r_{i-1} was zero";o=f;for(var l=this.field.Zero,c=r.getCoefficient(r.Degree),g=this.field.inverse(c);o.Degree>=r.Degree&&!o.Zero;){var v=o.Degree-r.Degree,m=this.field.multiply(o.getCoefficient(o.Degree),g);l=l.addOrSubtract(this.field.buildMonomial(v,m)),o=o.addOrSubtract(r.multiplyByMonomial(v,m))}a=l.multiply1(s).addOrSubtract(u),w=l.multiply1(h).addOrSubtract(d)}var b=w.getCoefficient(0);if(0==b)throw"ReedSolomonException sigmaTilde(0) was zero";var y=this.field.inverse(b),C=w.multiply2(y),_=o.multiply2(y);return new Array(C,_)},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var n=new Array(t),i=0,r=1;r<256&&i<t;r++)0==e.evaluateAt(r)&&(n[i]=this.field.inverse(r),i++);if(i!=t)throw"Error locator degree does not match number of roots";return n},this.findErrorMagnitudes=function(e,t,n){for(var i=t.length,r=new Array(i),o=0;o<i;o++){for(var s=this.field.inverse(t[o]),a=1,h=0;h<i;h++)o!=h&&(a=this.field.multiply(a,S.addOrSubtract(1,this.field.multiply(t[h],s))));r[o]=this.field.multiply(e.evaluateAt(s),this.field.inverse(a)),n&&(r[o]=this.field.multiply(r[o],s))}return r}}(S.QR_CODE_FIELD),x.correctErrors=function(e,t){for(var n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=255&e[r];var o=e.length-t;try{x.rsDecoder.decode(i,o)}catch(e){throw e}for(r=0;r<t;r++)e[r]=i[r]},x.decode=function(e){for(var t=new B(e),n=t.readVersion(),i=t.readFormatInformation().ErrorCorrectionLevel,r=t.readCodewords(),o=E.getDataBlocks(r,n,i),s=0,a=0;a<o.length;a++)s+=o[a].NumDataCodewords;for(var h=new Array(s),w=0,f=0;f<o.length;f++){var u=o[f],d=u.Codewords,l=u.NumDataCodewords;x.correctErrors(d,l);for(a=0;a<l;a++)h[w++]=d[a]}return new D(h,n.VersionNumber,i.Bits)};var F={};function I(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}return F.imagedata=null,F.width=0,F.height=0,F.qrCodeSymbol=null,F.debug=!1,F.maxImgSize=1048576,F.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],F.vidSuccess=function(e){F.localstream=e,F.webkit?F.video.src=window.webkitURL.createObjectURL(e):F.moz?(F.video.mozSrcObject=e,F.video.play()):F.video.src=e,F.gUM=!0,F.canvas_qr2=document.createElement("canvas"),F.canvas_qr2.id="qr-canvas",F.qrcontext2=F.canvas_qr2.getContext("2d"),F.canvas_qr2.width=F.video.videoWidth,F.canvas_qr2.height=F.video.videoHeight,setTimeout(F.captureToCanvas,500)},F.vidError=function(e){F.gUM=!1},F.captureToCanvas=function(){if(F.gUM)try{if(0==F.video.videoWidth)return void setTimeout(F.captureToCanvas,500);F.canvas_qr2.width=F.video.videoWidth,F.canvas_qr2.height=F.video.videoHeight,F.qrcontext2.drawImage(F.video,0,0);try{F.decode()}catch(e){console.log(e),setTimeout(F.captureToCanvas,500)}}catch(e){console.log(e),setTimeout(F.captureToCanvas,500)}},F.setWebcam=function(e){var t=navigator;F.video=document.getElementById(e);var n=!0;if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then((function(e){e.forEach((function(e){console.log("deb1"),"videoinput"===e.kind&&e.label.toLowerCase().search("back")>-1&&(n=[{sourceId:e.deviceId}]),console.log(e.kind+": "+e.label+" id = "+e.deviceId)}))}))}catch(e){console.log(e)}else console.log("no navigator.mediaDevices.enumerateDevices");t.getUserMedia?t.getUserMedia({video:n,audio:!1},F.vidSuccess,F.vidError):t.webkitGetUserMedia?(F.webkit=!0,t.webkitGetUserMedia({video:n,audio:!1},F.vidSuccess,F.vidError)):t.mozGetUserMedia&&(F.moz=!0,t.mozGetUserMedia({video:n,audio:!1},F.vidSuccess,F.vidError))},F.decode=function(e,t){if(0==arguments.length){if(F.canvas_qr2)var n=F.canvas_qr2,i=F.qrcontext2;else i=(n=document.getElementById("qr-canvas")).getContext("2d");return F.width=n.width,F.height=n.height,F.imagedata=i.getImageData(0,0,F.width,F.height),F.result=F.process(i),t&&t(F.result),F.result}var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){var e=document.getElementById("out-canvas");if(null!=e){var n=e.getContext("2d");n.clearRect(0,0,320,240),n.drawImage(r,0,0,320,240)}var i=document.createElement("canvas"),o=i.getContext("2d"),s=r.height,a=r.width;if(r.width*r.height>F.maxImgSize){var h=r.width/r.height;a=h*(s=Math.sqrt(F.maxImgSize/h))}i.width=a,i.height=s,o.drawImage(r,0,0,i.width,i.height),F.width=i.width,F.height=i.height;try{F.imagedata=o.getImageData(0,0,i.width,i.height)}catch(e){return F.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(t&&t(F.result))}try{F.result=F.process(o)}catch(e){console.log(e),F.result="error decoding QR Code"}t&&t(F.result)},r.onerror=function(){t&&t("Failed to load the image")},r.src=e},F.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},F.decode_url=function(e){var t="";try{t=escape(e)}catch(n){console.log(n),t=e}var n="";try{n=decodeURIComponent(t)}catch(e){console.log(e),n=t}return n},F.decode_utf8=function(e){return F.isUrl(e)?F.decode_url(e):e},F.process=function(e){var t=(new Date).getTime(),n=F.grayScaleToBitmap(F.grayscale());if(F.debug){for(var i=0;i<F.height;i++)for(var r=0;r<F.width;r++){var o=4*r+i*F.width*4;F.imagedata.data[o]=(n[r+i*F.width],0),F.imagedata.data[o+1]=(n[r+i*F.width],0),F.imagedata.data[o+2]=n[r+i*F.width]?255:0}e.putImageData(F.imagedata,0,0)}var s=new k(n).detect();if(F.debug){for(i=0;i<s.bits.Height;i++)for(r=0;r<s.bits.Width;r++){o=4*r*2+2*i*F.width*4;F.imagedata.data[o]=(s.bits.get_Renamed(r,i),0),F.imagedata.data[o+1]=(s.bits.get_Renamed(r,i),0),F.imagedata.data[o+2]=s.bits.get_Renamed(r,i)?255:0}e.putImageData(F.imagedata,0,0)}for(var a=x.decode(s.bits).DataByte,h="",w=0;w<a.length;w++)for(var f=0;f<a[w].length;f++)h+=String.fromCharCode(a[w][f]);var u=(new Date).getTime()-t;return console.log(u),F.decode_utf8(h)},F.getPixel=function(e,t){if(F.width<e)throw"point error";if(F.height<t)throw"point error";var n=4*e+t*F.width*4;return(33*F.imagedata.data[n]+34*F.imagedata.data[n+1]+33*F.imagedata.data[n+2])/100},F.binarize=function(e){for(var t=new Array(F.width*F.height),n=0;n<F.height;n++)for(var i=0;i<F.width;i++){var r=F.getPixel(i,n);t[i+n*F.width]=r<=e}return t},F.getMiddleBrightnessPerArea=function(e){for(var t=Math.floor(F.width/4),n=Math.floor(F.height/4),i=new Array(4),r=0;r<4;r++){i[r]=new Array(4);for(var o=0;o<4;o++)i[r][o]=new Array(0,0)}for(var s=0;s<4;s++)for(var a=0;a<4;a++){i[a][s][0]=255;for(var h=0;h<n;h++)for(var w=0;w<t;w++){var f=e[t*a+w+(n*s+h)*F.width];f<i[a][s][0]&&(i[a][s][0]=f),f>i[a][s][1]&&(i[a][s][1]=f)}}for(var u=new Array(4),d=0;d<4;d++)u[d]=new Array(4);for(s=0;s<4;s++)for(a=0;a<4;a++)u[a][s]=Math.floor((i[a][s][0]+i[a][s][1])/2);return u},F.grayScaleToBitmap=function(e){for(var t=F.getMiddleBrightnessPerArea(e),n=t.length,i=Math.floor(F.width/n),r=Math.floor(F.height/n),o=new ArrayBuffer(F.width*F.height),s=new Uint8Array(o),a=0;a<n;a++)for(var h=0;h<n;h++)for(var w=0;w<r;w++)for(var f=0;f<i;f++)s[i*h+f+(r*a+w)*F.width]=e[i*h+f+(r*a+w)*F.width]<t[h][a];return s},F.grayscale=function(){for(var e=new ArrayBuffer(F.width*F.height),t=new Uint8Array(e),n=0;n<F.height;n++)for(var i=0;i<F.width;i++){var r=F.getPixel(i,n);t[i+n*F.width]=r}return t},F}));
